<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="pandas是python中一个数据处理和科学分析的工具，它能做的很多，不过最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以，也是自动化办公的一个神器，也是我学习的主要目标。  安装使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢 1pip install pandas  处理excel数据，还需要一个插件（openpyxl）来读取&#x2F;写入excel 12#">
<meta property="og:type" content="article">
<meta property="og:title" content="pandas">
<meta property="og:url" content="https://ulomo.github.io/2020/04/18/pandas/index.html">
<meta property="og:site_name" content="秋日摘桂花做饼">
<meta property="og:description" content="pandas是python中一个数据处理和科学分析的工具，它能做的很多，不过最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以，也是自动化办公的一个神器，也是我学习的主要目标。  安装使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢 1pip install pandas  处理excel数据，还需要一个插件（openpyxl）来读取&#x2F;写入excel 12#">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418204331053.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418204439512.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417203430726.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417192602580.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/Desktop/Figure_1.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417202420437.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417202957849.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417220253777.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417220601412.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417223035065.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200417223407312.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418095053048.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418103216628.png">
<meta property="og:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418104716779.png">
<meta property="article:published_time" content="2020-04-18T14:55:13.000Z">
<meta property="article:modified_time" content="2020-06-24T13:35:05.364Z">
<meta property="article:author" content="fsl">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ulomo.github.io/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>pandas</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/04/20/powershell/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2020/04/15/%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ulomo.github.io/2020/04/18/pandas/" target="_blank" rel="noopener"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ulomo.github.io/2020/04/18/pandas/&text=pandas" target="_blank" rel="noopener"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ulomo.github.io/2020/04/18/pandas/&is_video=false&description=pandas" target="_blank" rel="noopener"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pandas&body=Check out this article: https://ulomo.github.io/2020/04/18/pandas/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ulomo.github.io/2020/04/18/pandas/&name=pandas&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#安装"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三种数据结构"><span class="toc-number">2.</span> <span class="toc-text">三种数据结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简单读取写入"><span class="toc-number">3.</span> <span class="toc-text">简单读取写入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#excel"><span class="toc-number">3.1.</span> <span class="toc-text">excel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql"><span class="toc-number">3.2.</span> <span class="toc-text">mysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlite"><span class="toc-number">3.3.</span> <span class="toc-text">sqlite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json"><span class="toc-number">3.4.</span> <span class="toc-text">json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#csv-tsv-txt"><span class="toc-number">3.5.</span> <span class="toc-text">csv&#x2F;tsv&#x2F;txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写入"><span class="toc-number">3.6.</span> <span class="toc-text">写入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DataFrame"><span class="toc-number">4.</span> <span class="toc-text">DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建"><span class="toc-number">4.1.</span> <span class="toc-text">创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自己指定index"><span class="toc-number">4.2.</span> <span class="toc-text">自己指定index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#通过index找出对应数据"><span class="toc-number">4.3.</span> <span class="toc-text">通过index找出对应数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#指定header"><span class="toc-number">4.4.</span> <span class="toc-text">指定header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看开头和结尾"><span class="toc-number">4.5.</span> <span class="toc-text">查看开头和结尾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看数据信息"><span class="toc-number">4.6.</span> <span class="toc-text">查看数据信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看行列数"><span class="toc-number">4.7.</span> <span class="toc-text">查看行列数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加与去重"><span class="toc-number">4.8.</span> <span class="toc-text">添加与去重</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加DataFrame"><span class="toc-number">4.8.1.</span> <span class="toc-text">添加DataFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加Series"><span class="toc-number">4.8.2.</span> <span class="toc-text">添加Series</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加列"><span class="toc-number">4.8.3.</span> <span class="toc-text">添加列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到重复数据"><span class="toc-number">4.8.4.</span> <span class="toc-text">找到重复数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#去重"><span class="toc-number">4.8.5.</span> <span class="toc-text">去重</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改"><span class="toc-number">4.9.</span> <span class="toc-text">修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#替换"><span class="toc-number">4.10.</span> <span class="toc-text">替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插入"><span class="toc-number">4.11.</span> <span class="toc-text">插入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#行"><span class="toc-number">4.11.1.</span> <span class="toc-text">行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列"><span class="toc-number">4.11.2.</span> <span class="toc-text">列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除"><span class="toc-number">4.12.</span> <span class="toc-text">删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#行-1"><span class="toc-number">4.12.1.</span> <span class="toc-text">行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列-1"><span class="toc-number">4.12.2.</span> <span class="toc-text">列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#columns"><span class="toc-number">4.13.</span> <span class="toc-text">columns</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Null数据行清除"><span class="toc-number">4.14.</span> <span class="toc-text">Null数据行清除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Null数据列的清除"><span class="toc-number">4.15.</span> <span class="toc-text">Null数据列的清除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用mean来填充null数据列"><span class="toc-number">4.16.</span> <span class="toc-text">使用mean来填充null数据列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取数据描述"><span class="toc-number">4.17.</span> <span class="toc-text">获取数据描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看某列数据相同数据的个数"><span class="toc-number">4.18.</span> <span class="toc-text">查看某列数据相同数据的个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重组DataFrame"><span class="toc-number">4.19.</span> <span class="toc-text">重组DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的过滤"><span class="toc-number">4.20.</span> <span class="toc-text">数据的过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#在Series的基础上过滤"><span class="toc-number">4.20.1.</span> <span class="toc-text">在Series的基础上过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在DataFrame基础上过滤"><span class="toc-number">4.20.2.</span> <span class="toc-text">在DataFrame基础上过滤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从指定行或列开始读取"><span class="toc-number">4.21.</span> <span class="toc-text">从指定行或列开始读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自动填充功能"><span class="toc-number">4.22.</span> <span class="toc-text">自动填充功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算功能"><span class="toc-number">4.23.</span> <span class="toc-text">计算功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x轴向乘法"><span class="toc-number">4.23.1.</span> <span class="toc-text">x轴向乘法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x轴向求和-平均"><span class="toc-number">4.23.2.</span> <span class="toc-text">x轴向求和&#x2F;平均</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#y轴向求和-平均并添加到DataFrame"><span class="toc-number">4.23.3.</span> <span class="toc-text">y轴向求和&#x2F;平均并添加到DataFrame</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#排序"><span class="toc-number">4.24.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据相关性"><span class="toc-number">4.25.</span> <span class="toc-text">数据相关性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从不同sheet页读取"><span class="toc-number">4.26.</span> <span class="toc-text">从不同sheet页读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多表联合查询"><span class="toc-number">4.27.</span> <span class="toc-text">多表联合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据列分割"><span class="toc-number">4.28.</span> <span class="toc-text">数据列分割</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#行列转换"><span class="toc-number">4.29.</span> <span class="toc-text">行列转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提取日期"><span class="toc-number">4.30.</span> <span class="toc-text">提取日期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组，聚合"><span class="toc-number">4.31.</span> <span class="toc-text">分组，聚合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#条件颜色"><span class="toc-number">4.32.</span> <span class="toc-text">条件颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#颜色条"><span class="toc-number">4.33.</span> <span class="toc-text">颜色条</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#渐变颜色"><span class="toc-number">4.34.</span> <span class="toc-text">渐变颜色</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Series"><span class="toc-number">5.</span> <span class="toc-text">Series</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Series序列"><span class="toc-number">5.1.</span> <span class="toc-text">Series序列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Series组装DataFrame"><span class="toc-number">5.2.</span> <span class="toc-text">Series组装DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DataFrame取出Series"><span class="toc-number">5.3.</span> <span class="toc-text">DataFrame取出Series</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#制图"><span class="toc-number">6.</span> <span class="toc-text">制图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#柱状图"><span class="toc-number">6.1.</span> <span class="toc-text">柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#中文支持"><span class="toc-number">6.2.</span> <span class="toc-text">中文支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用matplotlib修饰"><span class="toc-number">6.3.</span> <span class="toc-text">使用matplotlib修饰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组柱状图"><span class="toc-number">6.4.</span> <span class="toc-text">分组柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#叠加柱状图"><span class="toc-number">6.5.</span> <span class="toc-text">叠加柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#水平叠加柱状图"><span class="toc-number">6.6.</span> <span class="toc-text">水平叠加柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#饼图"><span class="toc-number">6.7.</span> <span class="toc-text">饼图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#折线图"><span class="toc-number">6.8.</span> <span class="toc-text">折线图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#叠加区域图"><span class="toc-number">6.9.</span> <span class="toc-text">叠加区域图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#散点图"><span class="toc-number">6.10.</span> <span class="toc-text">散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分布图"><span class="toc-number">6.11.</span> <span class="toc-text">分布图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#密度图"><span class="toc-number">6.12.</span> <span class="toc-text">密度图</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        pandas
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">秋日摘桂花做饼</span>
      </span>
      
    <div class="postdate">
        <time datetime="2020-04-18T14:55:13.000Z" itemprop="datePublished">2020-04-18</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/python/" rel="tag">python</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>pandas是python中一个数据处理和科学分析的工具，它能做的很多，不过最为强大的就是数据处理。由于它可以很轻松的处理excel数据，所以，也是自动化办公的一个神器，也是我学习的主要目标。</p>
</blockquote>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>使用pip来安装pandas，pip需要先配置国内源，不然下载速度很慢</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br></pre></td></tr></table></figure>

<p>处理excel数据，还需要一个插件（openpyxl）来读取/写入excel</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> openpyxl (3.0.3)    - A Python library to <span class="built_in">read</span>/write Excel 2010 xlsx/xlsm files</span></span><br><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure>



<h1 id="三种数据结构"><a href="#三种数据结构" class="headerlink" title="三种数据结构"></a>三种数据结构</h1><table>
<thead>
<tr>
<th>数据结构</th>
<th>维度</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td>Series</td>
<td>一维</td>
<td>同构（数据类型相同），表示一列column</td>
</tr>
<tr>
<td>DataFrame</td>
<td>二维</td>
<td>异构，表示一个表格table</td>
</tr>
<tr>
<td>Panel</td>
<td>三维</td>
<td>异构，使用的少</td>
</tr>
</tbody></table>
<p>由于具有DataFrame这种二维数据结构，所以可以处理很多类似数据结构的文件，比如：excel，sql，json等</p>
<h1 id="简单读取写入"><a href="#简单读取写入" class="headerlink" title="简单读取写入"></a>简单读取写入</h1><p><strong>读取数据的时候可以直接指定index列<code>index_col=</code></strong></p>
<p><strong>数据如果太长显示不了，可以设置显示宽度<code>pandas.options.display.max_columns=num</code></strong></p>
<h2 id="excel"><a href="#excel" class="headerlink" title="excel"></a>excel</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入数据到excel</span></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">90</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df.to_excel(<span class="string">'/home/narcissus/Desktop/1.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从excel读取数据</span></span><br><span class="line">pe = pd.read_excel(<span class="string">"/home/narcissus/Desktop/1.xlsx"</span>, index_col=<span class="string">'name'</span>)</span><br><span class="line">print(pe)</span><br></pre></td></tr></table></figure>

<h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><p>需要安装数据库连接驱动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pymysql</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">host = <span class="string">'192.168.0.105'</span></span><br><span class="line">user = <span class="string">'pi'</span></span><br><span class="line">password = input(<span class="string">"password for mysql connection: "</span>)</span><br><span class="line">database = <span class="string">'mytestdb'</span></span><br><span class="line">con = pymysql.connect(host,user,password,database)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">df = pd.read_sql_query(<span class="string">'select * from ssacount limit 0,10'</span>,con)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以将数据库中读取到的数据直接写入excel中</span></span><br><span class="line">df.to_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="sqlite"><a href="#sqlite" class="headerlink" title="sqlite"></a>sqlite</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line">con = sqlite3.connect(<span class="string">"testdatabase.db"</span>)</span><br><span class="line">df = pd.read_sql_query(<span class="string">"SELECT * FROM ssacount"</span>, con)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<h2 id="json"><a href="#json" class="headerlink" title="json"></a>json</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_json(<span class="string">'test.json'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="csv-tsv-txt"><a href="#csv-tsv-txt" class="headerlink" title="csv/tsv/txt"></a>csv/tsv/txt</h2><p>pandas只有一个<code>read_csv()</code>函数，但是却可以读取这三种文件（文本文件都可以），默认读取csv文件，其分隔符为逗号，所以在读取tsv和txt的时候，要手动设置分隔符<code>sep=&#39;&#39;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'1.csv'</span>)</span><br><span class="line">df = pd.read_csv(<span class="string">'1.tsv'</span>, sep=<span class="string">'\t'</span>)</span><br><span class="line">df = pd.read_csv(<span class="string">'1.txt'</span>, sep=<span class="string">'文件中的特殊分隔符号'</span>)</span><br></pre></td></tr></table></figure>



<h2 id="写入"><a href="#写入" class="headerlink" title="写入"></a>写入</h2><p>值得注意的是在写入文件之前要确保去掉默认的index，需要设置成自己指定的index，否则再读取文件时，会有一个unamed的列（之前的index列）。其实可以用后面学习的<code>skiprows</code>在读取时指定跳过多少行，以及<code>usecols</code>来跳过指定列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="literal">None</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="literal">None</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="comment"># 写入文件之前需要去掉默认的index</span></span><br><span class="line">df.set_index(<span class="string">'name'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.to_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line"><span class="comment"># 读取数据时指定index</span></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, index_col=<span class="string">'name'</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.to_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line"></span><br><span class="line">df.to_json(<span class="string">'~/Desktop/test.json'</span>)</span><br><span class="line"></span><br><span class="line">df.to_sql(<span class="string">'ssacount'</span>, con)</span><br></pre></td></tr></table></figure>



<p><strong>PS:</strong> 按照目前我的理解，pandas可以完美的完成这些数据文件之间的转换。可以将json，数据库中的数据导入到excel中进行可视化操作。</p>
<h1 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h1><p>作为最重要的一个部分，DataFrame包含了几百种方法和操作，可以对数据进行任何的分析与处理。</p>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>创建的方式比较多，但通常都是使用<code>dict</code>来创建。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    	<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], </span><br><span class="line">        <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], </span><br><span class="line">        <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">90</span>,<span class="number">100</span>]</span><br><span class="line">       &#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<p>每一对key-value作为一个Series(column)，key作为表头，value作为数据</p>
<h2 id="自己指定index"><a href="#自己指定index" class="headerlink" title="自己指定index"></a>自己指定index</h2><p>默认会自动创建一个index列，为从0开始的连续数据。可以自己指定某列为索引列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用set_index()方法</span></span><br><span class="line">df = df.set_index(<span class="string">"name"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者在DataFrame中指定index</span></span><br><span class="line">df = pd.DataFrame(data, index=[<span class="string">'一班'</span>,<span class="string">'二班'</span>,<span class="string">'二班'</span>])</span><br></pre></td></tr></table></figure>

<p>需要注意的是这个index的数据是可以重复的，并不需要唯一性</p>
<h2 id="通过index找出对应数据"><a href="#通过index找出对应数据" class="headerlink" title="通过index找出对应数据"></a>通过index找出对应数据</h2><p>可以通过<code>loc</code>找出来的条件是设置了index，否则无法找到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sear = df.loc[<span class="string">'一班'</span>]</span><br><span class="line">print(sear)</span><br><span class="line"></span><br><span class="line">name     韩信</span><br><span class="line">age      <span class="number">21</span></span><br><span class="line">score    <span class="number">80</span></span><br><span class="line">Name: 一班, dtype: object</span><br></pre></td></tr></table></figure>

<p>可以看出index与其对应数据也是一个<code>dict</code>数据类型</p>
<p>即使设置了index，也可以通过默认的index来查找<code>iloc</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sear = df.iloc[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<h2 id="指定header"><a href="#指定header" class="headerlink" title="指定header"></a>指定header</h2><p>默认header=0,会使用第0行（index为空）/excel中的第一行作为header，即columns</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, header=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>重新自定义header，能够自定义成功的前提是这个文件本身就没有header，否则原来的header会作为一个数据行成为index=0的那一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, header=<span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 取指定列</span></span><br><span class="line">df = df[[<span class="number">1</span>,<span class="number">3</span>]]</span><br><span class="line"><span class="comment"># 设置header</span></span><br><span class="line">df.columns = [<span class="number">1</span>,<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<h2 id="查看开头和结尾"><a href="#查看开头和结尾" class="headerlink" title="查看开头和结尾"></a>查看开头和结尾</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认为5行</span></span><br><span class="line">df.head()</span><br><span class="line">df.tail()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以自己指定显示多少行</span></span><br><span class="line">df.head(<span class="number">20</span>)</span><br><span class="line">df.tail(<span class="number">20</span>)</span><br></pre></td></tr></table></figure>



<h2 id="查看数据信息"><a href="#查看数据信息" class="headerlink" title="查看数据信息"></a>查看数据信息</h2><p><code>.info()</code>提供了很重要的一些信息，包括行，列，数据是否为空，数据类型，内存占用等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">info = df.info()</span><br><span class="line">print(info)</span><br><span class="line"></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">pandas</span>.<span class="title">core</span>.<span class="title">frame</span>.<span class="title">DataFrame</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">RangeIndex</span>:</span> <span class="number">3</span> entries, <span class="number">0</span> to <span class="number">2</span></span><br><span class="line">Data columns (total <span class="number">3</span> columns):</span><br><span class="line"> <span class="comment">#   Column  Non-Null Count  Dtype </span></span><br><span class="line">---  ------  --------------  ----- </span><br><span class="line"> <span class="number">0</span>   name    <span class="number">3</span> non-null      object</span><br><span class="line"> <span class="number">1</span>   age     <span class="number">3</span> non-null      int64 </span><br><span class="line"> <span class="number">2</span>   score   <span class="number">3</span> non-null      int64 </span><br><span class="line">dtypes: int64(<span class="number">2</span>), object(<span class="number">1</span>)</span><br><span class="line">memory usage: <span class="number">200.0</span>+ bytes</span><br><span class="line"><span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h2 id="查看行列数"><a href="#查看行列数" class="headerlink" title="查看行列数"></a>查看行列数</h2><p><code>.shape</code>提供了一个简单快速查看总行数，列数的信息(rows,columns)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info = df.shape</span><br><span class="line">print(info)</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>



<h2 id="添加与去重"><a href="#添加与去重" class="headerlink" title="添加与去重"></a>添加与去重</h2><h3 id="添加DataFrame"><a href="#添加DataFrame" class="headerlink" title="添加DataFrame"></a>添加DataFrame</h3><ul>
<li>df.append()</li>
<li>pandas.concat([])</li>
</ul>
<p><code>.append()</code>可以将已有的DataFrame追加。但是index不会自动变化，要是index自动变化，需要调用<code>reset_index(drop=True)</code></p>
<p>append如果需要将Series追加到行后面，必须加一个参数<code>ignore_index=True</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">tmp_df = df.append(df)</span><br><span class="line">print(tmp_df)</span><br><span class="line"></span><br><span class="line">    name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">tmp_df = df.append(df).reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">print(tmp_df)</span><br><span class="line"></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br><span class="line"><span class="number">4</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">5</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">6</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">7</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>使用concat默认y轴添加，使用axis=1则x轴添加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">tmp_df = pd.concat([df,df], axis=<span class="number">0</span>).reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">print(tmp_df)</span><br></pre></td></tr></table></figure>





<h3 id="添加Series"><a href="#添加Series" class="headerlink" title="添加Series"></a>添加Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">add = pd.Series(&#123;<span class="string">'name'</span>:<span class="string">'筱倩'</span>, <span class="string">'age'</span>:<span class="number">30</span>, <span class="string">'score'</span>:<span class="number">88</span>&#125;)</span><br><span class="line">df = df.append(add, ignore_index=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br><span class="line"><span class="number">4</span>   筱倩   <span class="number">30</span>     <span class="number">88</span></span><br></pre></td></tr></table></figure>



<h3 id="添加列"><a href="#添加列" class="headerlink" title="添加列"></a>添加列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'column_name'</span>] = []</span><br><span class="line">tmp_df[<span class="string">'add'</span>] = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(max(tmp_df.index)+<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>



<h3 id="找到重复数据"><a href="#找到重复数据" class="headerlink" title="找到重复数据"></a>找到重复数据</h3><p><code>df.dumpllicateed(subset=&#39;column_name&#39;)</code>可以找出指定列的重复index，和True/False的Series。那么如何通过index来找到真正的重复数据？可以通过循环，其实更加简单的方式是使用<code>df.iloc[index]</code>定位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">dum = df.duplicated(subset=<span class="string">'name'</span>)</span><br><span class="line"><span class="comment"># 查看是否存在重复数据</span></span><br><span class="line">print(dum.any())</span><br><span class="line">dum = dum[dum == <span class="literal">True</span>] <span class="comment">#可以简化为dum = dum[dum]</span></span><br><span class="line">info = df.iloc[dum.index]</span><br><span class="line">print(info)</span><br><span class="line"></span><br><span class="line"><span class="literal">True</span></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br></pre></td></tr></table></figure>



<h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p><code>.drop_duplicates()</code>可以将追加的重复数据清除，需要加上<code>inplace=True</code>这个参数，否则不会生效。</p>
<ul>
<li>默认会对整个表的数据进行去重，如果需要对指定列，那么添加参数<code>subset=&#39;column_name&#39;</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tmp_df.drop_duplicates(subset=<span class="string">'score'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p><code>.drop_duplicates()</code>的<code>keep</code>参数：</p>
<ul>
<li>first，保留第一次出现的，默认</li>
<li>last，保留最后一次出现的</li>
<li>False，去除所有重复数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tmp_df.drop_duplicates(inplace=<span class="literal">True</span>, keep=<span class="string">'first'</span>)</span><br><span class="line"></span><br><span class="line">    name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tmp_df.drop_duplicates(inplace=<span class="literal">True</span>, keep=<span class="string">'last'</span>)</span><br><span class="line"></span><br><span class="line">    name  age  score</span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tmp_df.drop_duplicates(inplace=<span class="literal">True</span>, keep=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">Empty DataFrame</span><br><span class="line">Columns: [name, age, score]</span><br><span class="line">Index: []</span><br></pre></td></tr></table></figure>



<h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><p>通过df[‘column_name’]/df.column_name可以获取Series，通过Series[index]可以获取到指定的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df.name[<span class="number">1</span>] = <span class="string">'筱倩'</span></span><br><span class="line">df.age[<span class="number">1</span>] = <span class="number">99</span></span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   筱倩   <span class="number">99</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>



<h2 id="替换"><a href="#替换" class="headerlink" title="替换"></a>替换</h2><p>使用到了<code>df.iloc[index]</code>定位，并用Series进行替换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">alert = pd.Series(&#123;<span class="string">'name'</span>:<span class="string">'筱倩'</span>, <span class="string">'age'</span>:<span class="number">30</span>, <span class="string">'score'</span>:<span class="number">88</span>&#125;)</span><br><span class="line">df.iloc[<span class="number">1</span>] = alert</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><h3 id="行"><a href="#行" class="headerlink" title="行"></a>行</h3><p>使用到了df[]切片以及追加操作。值得注意的是：在python中可以对list进行切片，但是在pandas中还可以对DataFrame这种二维数据进行切片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">insert = pd.Series(&#123;<span class="string">'name'</span>:<span class="string">'筱倩'</span>, <span class="string">'age'</span>:<span class="number">30</span>, <span class="string">'score'</span>:<span class="number">88</span>&#125;)</span><br><span class="line">part1 = df[:<span class="number">2</span>]</span><br><span class="line">part2 = df[<span class="number">2</span>:]</span><br><span class="line">df = part1.append(insert, ignore_index=<span class="literal">True</span>).append(part2).reset_index(drop=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   筱倩   <span class="number">30</span>     <span class="number">88</span></span><br><span class="line"><span class="number">3</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">4</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<h3 id="列"><a href="#列" class="headerlink" title="列"></a>列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># num为想插入到第几列前面</span></span><br><span class="line">df.insert(num, column=<span class="string">'column_name'</span>, value=[])</span><br></pre></td></tr></table></figure>



<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><h3 id="行-1"><a href="#行-1" class="headerlink" title="行"></a>行</h3><p>两种方法：</p>
<ul>
<li>使用到了<code>df.drop(index=[], inplace=True)</code></li>
<li>可以使用切片，将需要的数据切出来然后append组合</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"韩信"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">insert = pd.Series(&#123;<span class="string">'name'</span>:<span class="string">'筱倩'</span>, <span class="string">'age'</span>:<span class="number">30</span>, <span class="string">'score'</span>:<span class="number">88</span>&#125;)</span><br><span class="line">part1 = df[:<span class="number">1</span>]</span><br><span class="line">part2 = df[<span class="number">2</span>:]</span><br><span class="line"><span class="comment"># index后面可以跟一个list集合，也可以是一个range()函数</span></span><br><span class="line">df.drop(index=<span class="number">2</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 使用切片然后组合</span></span><br><span class="line"><span class="comment"># df = part1.append(part2).reset_index(drop=True)</span></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<h3 id="列-1"><a href="#列-1" class="headerlink" title="列"></a>列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(columns=[],inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>



<h2 id="columns"><a href="#columns" class="headerlink" title="columns"></a>columns</h2><p><code>.columns</code>可获取所有列名，返回的是一个列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(df.columns)</span><br><span class="line"></span><br><span class="line">Index([<span class="string">'name'</span>, <span class="string">'age'</span>, <span class="string">'score'</span>], dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></table></figure>

<p><code>.rename()</code>可修改列名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">'name'</span>:<span class="string">'Name'</span>, <span class="string">'age'</span>:<span class="string">'AGE'</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p><code>col.lower()</code>搭配列表生成式可以转换小写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.columns = [col.lower() <span class="keyword">for</span> col <span class="keyword">in</span> df.columns]</span><br></pre></td></tr></table></figure>



<h2 id="Null数据行清除"><a href="#Null数据行清除" class="headerlink" title="Null数据行清除"></a>Null数据行清除</h2><p><code>.isnull()</code>找出null数据，null数据显示True，非空数据显示False</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df.isnull())</span><br></pre></td></tr></table></figure>

<p><code>.sum()</code>计算总的null数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df.isnull().sum())</span><br></pre></td></tr></table></figure>

<p><code>.dropna()</code>删除有null数据的行，只要有一个null数据就会清除</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>可以看到这种清除数据的缺点，无法对指定列的Null数据进行清除，所以需要使用到过滤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="literal">None</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">21</span>,<span class="literal">None</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line"><span class="comment"># 为了能够找到手动输入的None数据列，对其进行了转换</span></span><br><span class="line">df = pd.DataFrame(data).fillna(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">miss = df.loc[df.name == <span class="number">0</span> ].index</span><br><span class="line">df.drop(index=miss, inplace=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">	name   age  score</span><br><span class="line"><span class="number">0</span>   韩信  <span class="number">21.0</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">0.0</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫  <span class="number">24.0</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>



<h2 id="Null数据列的清除"><a href="#Null数据列的清除" class="headerlink" title="Null数据列的清除"></a>Null数据列的清除</h2><p><code>.dropna(axis=1)</code>使用了一个参数axis</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.dropna(inplace=<span class="literal">True</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>为什么是1？在我们使用df.shape的时候返回一个tuple，(rows,columns)，可以看出columns的索引为1</p>
<h2 id="使用mean来填充null数据列"><a href="#使用mean来填充null数据列" class="headerlink" title="使用mean来填充null数据列"></a>使用mean来填充null数据列</h2><p><code>.fillna(column_name, inplace=True)</code>如果将有null的数据列都删除的话， 那么数据的缺失会比较大，可以用平均值来填充</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="literal">None</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="literal">None</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出age列</span></span><br><span class="line">age = df[<span class="string">'age'</span>]</span><br><span class="line"><span class="comment"># 取平均值</span></span><br><span class="line">age_mean = age.mean()</span><br><span class="line"><span class="comment"># 将age列中的null用平均值填充</span></span><br><span class="line">age.fillna(age_mean, inplace=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="获取数据描述"><a href="#获取数据描述" class="headerlink" title="获取数据描述"></a>获取数据描述</h2><p>前面用<code>.info()</code>获取了对DataFrame的描述，但是<code>.describe()</code>可以获取关于数据的描述：包括最大值，最小值，平均值，列数，行数等。既可以是整个DataFrame，也可以是某一列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 整个表</span></span><br><span class="line">print(df.describe())</span><br><span class="line"><span class="comment"># age列</span></span><br><span class="line">print(df[<span class="string">'age'</span>].describe())</span><br></pre></td></tr></table></figure>



<h2 id="查看某列数据相同数据的个数"><a href="#查看某列数据相同数据的个数" class="headerlink" title="查看某列数据相同数据的个数"></a>查看某列数据相同数据的个数</h2><p><code>.value_counts()</code>指定列的数据出现个数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df[<span class="string">'score'</span>].value_counts())</span><br></pre></td></tr></table></figure>



<h2 id="重组DataFrame"><a href="#重组DataFrame" class="headerlink" title="重组DataFrame"></a>重组DataFrame</h2><p><code>type(df[&#39;age&#39;])</code>的类型是一个serise，而<code>type(df[[&#39;age&#39;]])</code>的类型是一个DataFrame，所以可以使用这种方式来重新选取需要的列构成新的DataFrame</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">new_df = df[[<span class="string">'name'</span>, <span class="string">'age'</span>]]</span><br><span class="line">print(new_df)</span><br></pre></td></tr></table></figure>



<h2 id="数据的过滤"><a href="#数据的过滤" class="headerlink" title="数据的过滤"></a>数据的过滤</h2><h3 id="在Series的基础上过滤"><a href="#在Series的基础上过滤" class="headerlink" title="在Series的基础上过滤"></a>在Series的基础上过滤</h3><p>用条件判断来过滤数据：<code>&gt; &lt; == !=</code>等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">info = (df[<span class="string">'score'</span>] == <span class="number">80</span>)</span><br><span class="line">print(info)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以得到true of false的返回值</span></span><br><span class="line"><span class="number">0</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">1</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">2</span>     <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>    <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>如果想要直接得到过滤后的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">info = df[df[<span class="string">'score'</span>] == <span class="number">80</span>]</span><br><span class="line">print(info)</span><br><span class="line"></span><br><span class="line">   name   age  score</span><br><span class="line"><span class="number">0</span>    韩信  <span class="number">21.0</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   <span class="literal">None</span>   NaN     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>    李白  <span class="number">22.0</span>     <span class="number">80</span></span><br></pre></td></tr></table></figure>

<p>还可以使用逻辑判断</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info = df[(df[<span class="string">'score'</span>] &gt; <span class="number">80</span>) | (df[<span class="string">'age'</span>] == <span class="number">22</span>)]</span><br></pre></td></tr></table></figure>

<p>使用<code>isin()</code>更加简洁</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">info = df[df[<span class="string">'age'</span>].isin([<span class="number">21</span>,<span class="number">22</span>])]</span><br></pre></td></tr></table></figure>

<p><strong><em>上面的所有方法都很简洁，但是数据量比较大的时候，效率就比较低</em></strong></p>
<p>所以我们需要使用函数来进行过滤，使用<code>.apply()</code>将column传递给函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_score</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">info = df.loc[df[<span class="string">'score'</span>].apply(filter_score)]</span><br><span class="line"><span class="comment"># 简化</span></span><br><span class="line">info = df[df[<span class="string">'score'</span>].apply(filter_score)]</span><br><span class="line"><span class="comment"># 简化，其实我不理解为什么可以这么写</span></span><br><span class="line">info = df[df.score.apply(filter_score)]</span><br></pre></td></tr></table></figure>

<p>可以使用匿名函数简化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">info = df[df[<span class="string">'score'</span>].apply(<span class="keyword">lambda</span> x : x == <span class="number">100</span>)]</span><br><span class="line"><span class="comment"># 再简化</span></span><br><span class="line">info = df[df.score.apply(<span class="keyword">lambda</span> x : x == <span class="number">100</span>)]</span><br></pre></td></tr></table></figure>



<h3 id="在DataFrame基础上过滤"><a href="#在DataFrame基础上过滤" class="headerlink" title="在DataFrame基础上过滤"></a>在DataFrame基础上过滤</h3><p><code>axis=1</code>表示每一行（x轴），<code>axis=0</code>表示每一列（y轴）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_score</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x.score == <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">info = df.apply(filter_score， axis=<span class="number">1</span>)</span><br><span class="line">print(info)</span><br></pre></td></tr></table></figure>



<h2 id="从指定行或列开始读取"><a href="#从指定行或列开始读取" class="headerlink" title="从指定行或列开始读取"></a>从指定行或列开始读取</h2><p>可能表格并不是从第一行第一列开始写的，所以需要指定从哪里开始读取，否则会出现许多的unamed row和Nan值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里包含了一个空行，和一个index列，读取的时候会出现这些问题</span></span><br><span class="line">Unnamed: <span class="number">0</span> Unnamed: <span class="number">1</span> Unnamed: <span class="number">2</span> Unnamed: <span class="number">3</span></span><br><span class="line"><span class="number">0</span>         NaN       name        age      score</span><br><span class="line"><span class="number">1</span>         <span class="number">0.0</span>         韩信         <span class="number">21</span>         <span class="number">80</span></span><br><span class="line"><span class="number">2</span>         <span class="number">1.0</span>         韩信         <span class="number">22</span>         <span class="number">80</span></span><br><span class="line"><span class="number">3</span>         <span class="number">2.0</span>         李白         <span class="number">22</span>         <span class="number">80</span></span><br><span class="line"><span class="number">4</span>         <span class="number">3.0</span>         杜甫         <span class="number">24</span>        <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>使用<code>skiprows(num)</code>和<code>usecols=[]</code>来选取需要的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="comment"># 或者使用列名指定</span></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="string">'name'</span>,<span class="string">'age'</span>,<span class="string">'score'</span>])</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样就能读取需要的数据了</span></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<h2 id="自动填充功能"><a href="#自动填充功能" class="headerlink" title="自动填充功能"></a>自动填充功能</h2><p>用python来实现excel中拖拽自动填充的功能，生成序列数据进行填充，比较复杂的是日期的处理</p>
<ul>
<li>连续数据：list赋值</li>
<li>交叉数据：三目运算</li>
<li>日期数据：自定义函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date,timedelta</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">'name'</span>:[<span class="string">'李白'</span>,<span class="string">'杜甫'</span>,<span class="string">'白居易'</span>,<span class="string">'王维'</span>], <span class="string">'age'</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>], <span class="string">'birthday'</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>], <span class="string">'drink'</span>:[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line">	name   age birthday drink</span><br><span class="line"><span class="number">0</span>   李白  <span class="literal">None</span>     <span class="literal">None</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">1</span>   杜甫  <span class="literal">None</span>     <span class="literal">None</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">2</span>  白居易  <span class="literal">None</span>     <span class="literal">None</span>  <span class="literal">None</span></span><br><span class="line"><span class="number">3</span>   王维  <span class="literal">None</span>     <span class="literal">None</span>  <span class="literal">None</span></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化日期</span></span><br><span class="line">start = date(<span class="number">1600</span>,<span class="number">1</span>,<span class="number">31</span>)</span><br><span class="line"><span class="comment"># 定义日期处理函数，传一个开始日期以及添加的月份</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_month</span><span class="params">(start_date, add_month)</span>:</span></span><br><span class="line">    tmonth = start_date.month + add_month</span><br><span class="line">    cyear = start_date.year + tmonth // <span class="number">12</span> </span><br><span class="line">    cmonth = <span class="number">12</span> <span class="keyword">if</span> tmonth % <span class="number">12</span>  == <span class="number">0</span> <span class="keyword">else</span> tmonth % <span class="number">12</span></span><br><span class="line">    cday = start_date.day</span><br><span class="line">	<span class="comment"># 由于不同月份的天数不同，所以需要考虑</span></span><br><span class="line">    <span class="keyword">if</span> cday &gt; <span class="number">28</span>:</span><br><span class="line">        <span class="keyword">if</span> cmonth == <span class="number">2</span>:</span><br><span class="line">            cday = <span class="number">29</span> <span class="keyword">if</span> cyear % <span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> cyear % <span class="number">100</span> != <span class="number">0</span> <span class="keyword">or</span> cyear % <span class="number">400</span> == <span class="number">0</span> <span class="keyword">else</span> <span class="number">28</span></span><br><span class="line">        <span class="keyword">elif</span> cday == <span class="number">31</span> <span class="keyword">and</span> cmonth <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>]:</span><br><span class="line">            cday = <span class="number">31</span></span><br><span class="line">        <span class="keyword">elif</span> cday == <span class="number">31</span> <span class="keyword">and</span> cmonth <span class="keyword">in</span> [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>]:</span><br><span class="line">            cday = <span class="number">30</span></span><br><span class="line">    <span class="keyword">return</span> date(cyear,cmonth,cday)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对age进行填充，使用到了list的赋值</span></span><br><span class="line">df[<span class="string">'age'</span>] = [i+<span class="number">20</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(df.shape[<span class="number">1</span>])]</span><br><span class="line"><span class="comment"># 使用循环index，来对每一项进行赋值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> df.index:</span><br><span class="line">    <span class="comment"># 用到了三目运算，实现交叉数据填充</span></span><br><span class="line">    df[<span class="string">'drink'</span>][i] = <span class="string">'like'</span> <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'hate'</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># day递增的情况：day的相加有对应的函数</span></span><br><span class="line">    df[<span class="string">'birthday'</span>][i] = start + timedelta(days=i)</span><br><span class="line">	<span class="comment"># year递增的情况：year的相加可以在year上直接添加</span></span><br><span class="line">    df[<span class="string">'birthday'</span>][i] = date(start.year+i, start.month, start.day)</span><br><span class="line">	<span class="comment"># month递增的情况：比较复杂，涉及到year与month进位的问题，调用自定义函数实现</span></span><br><span class="line">    df[<span class="string">'birthday'</span>][i] = add_month(start,i+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line">	name  age    birthday drink</span><br><span class="line"><span class="number">0</span>   李白   <span class="number">20</span>  <span class="number">1600</span><span class="number">-11</span><span class="number">-30</span>  like</span><br><span class="line"><span class="number">1</span>   杜甫   <span class="number">21</span>  <span class="number">1601</span><span class="number">-12</span><span class="number">-31</span>  hate</span><br><span class="line"><span class="number">2</span>  白居易   <span class="number">22</span>  <span class="number">1601</span><span class="number">-01</span><span class="number">-31</span>  like</span><br><span class="line"><span class="number">3</span>   王维   <span class="number">23</span>  <span class="number">1601</span><span class="number">-02</span><span class="number">-28</span>  hate</span><br><span class="line">=======================================================================================</span><br></pre></td></tr></table></figure>



<h2 id="计算功能"><a href="#计算功能" class="headerlink" title="计算功能"></a>计算功能</h2><h3 id="x轴向乘法"><a href="#x轴向乘法" class="headerlink" title="x轴向乘法"></a>x轴向乘法</h3><p>使用到了pandas特有的list相乘，以及list展开相乘（这在python语法中是没有的，乘也是list的复制）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sr1 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">24</span>])</span><br><span class="line">sr2 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>])</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:sr1, <span class="string">'B'</span>:sr2&#125;)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pandas的list乘</span></span><br><span class="line">df[<span class="string">'C'</span>] = df[<span class="string">'A'</span>] * df[<span class="string">'B'</span>]</span><br><span class="line">df[<span class="string">'D'</span>] = df[<span class="string">'C'</span>] * <span class="number">100</span></span><br><span class="line"><span class="comment"># 可以使用apply()</span></span><br><span class="line">df[<span class="string">'E'</span>] = df[<span class="string">'B'</span>].apply(<span class="keyword">lambda</span> x:x+<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">A    B</span><br><span class="line"><span class="number">0</span>  <span class="number">21</span>   <span class="number">80</span></span><br><span class="line"><span class="number">1</span>  <span class="number">18</span>   <span class="number">80</span></span><br><span class="line"><span class="number">2</span>  <span class="number">22</span>   <span class="number">80</span></span><br><span class="line"><span class="number">3</span>  <span class="number">24</span>  <span class="number">100</span></span><br><span class="line">    A    B     C       D    E</span><br><span class="line"><span class="number">0</span>  <span class="number">21</span>   <span class="number">80</span>  <span class="number">1680</span>  <span class="number">168000</span>   <span class="number">82</span></span><br><span class="line"><span class="number">1</span>  <span class="number">18</span>   <span class="number">80</span>  <span class="number">1440</span>  <span class="number">144000</span>   <span class="number">82</span></span><br><span class="line"><span class="number">2</span>  <span class="number">22</span>   <span class="number">80</span>  <span class="number">1760</span>  <span class="number">176000</span>   <span class="number">82</span></span><br><span class="line"><span class="number">3</span>  <span class="number">24</span>  <span class="number">100</span>  <span class="number">2400</span>  <span class="number">240000</span>  <span class="number">102</span></span><br></pre></td></tr></table></figure>

<h3 id="x轴向求和-平均"><a href="#x轴向求和-平均" class="headerlink" title="x轴向求和/平均"></a>x轴向求和/平均</h3><p>前面都是使用的Series来进行计算的，如果需要的不止一列的数据呢？比如说需要每一行的和和平均值，当然也可以将所有列写出来计算，但是有点麻烦，其实可以指定轴。它会自动过滤掉文字列，只计算数字列。(索引不会计算)</p>
<p><code>axis=1</code>指定x轴，按行计算，从上到下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">table = df1.join(df2, how=<span class="string">'left'</span>).fillna(<span class="number">0</span>)</span><br><span class="line">table[<span class="string">'qq'</span>] = table[<span class="string">'qq'</span>].astype(int)</span><br><span class="line"></span><br><span class="line">table[<span class="string">'sum'</span>] = table.sum(axis=<span class="number">1</span>)</span><br><span class="line">table[<span class="string">'mean'</span>] = table.mean(axis=<span class="number">1</span>).astype(int)</span><br><span class="line">print(table)</span><br><span class="line"></span><br><span class="line">	name  age  score student          qq         sum        mean</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span>      韩信   <span class="number">124242423</span>   <span class="number">124242524</span>    <span class="number">62121262</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span>      赵云    <span class="number">12342356</span>    <span class="number">12342388</span>     <span class="number">6171194</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span>      李白   <span class="number">574534563</span>   <span class="number">574534615</span>   <span class="number">287267307</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span>      杜甫     <span class="number">6785842</span>     <span class="number">6785966</span>     <span class="number">3392983</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span>      曹操    <span class="number">34563342</span>    <span class="number">34563435</span>    <span class="number">17281717</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span>      姜尚    <span class="number">57845262</span>    <span class="number">57845382</span>    <span class="number">28922691</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span>      阿狗    <span class="number">45645834</span>    <span class="number">45645868</span>    <span class="number">22822934</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span>      筱倩    <span class="number">58364743</span>    <span class="number">58364845</span>    <span class="number">29182422</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span>      夫子  <span class="number">4824854834</span>  <span class="number">4824855064</span>  <span class="number">2412427532</span></span><br><span class="line"><span class="number">9</span>   葛聂   <span class="number">33</span>     <span class="number">90</span>       <span class="number">0</span>           <span class="number">0</span>         <span class="number">123</span>          <span class="number">61</span></span><br></pre></td></tr></table></figure>

<h3 id="y轴向求和-平均并添加到DataFrame"><a href="#y轴向求和-平均并添加到DataFrame" class="headerlink" title="y轴向求和/平均并添加到DataFrame"></a>y轴向求和/平均并添加到DataFrame</h3><ul>
<li>必须设置<code>ignore_index=True</code>，否则无法添加</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">table = df1.join(df2, how=<span class="string">'left'</span>).fillna(<span class="number">0</span>)</span><br><span class="line">table[<span class="string">'qq'</span>] = table[<span class="string">'qq'</span>].astype(int)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里省略了axis=0,因为这是默认值</span></span><br><span class="line">total = table.mean()</span><br><span class="line">sum = table.sum()</span><br><span class="line"><span class="comment"># total为一个Series，可以设置name值</span></span><br><span class="line">total[<span class="string">'name'</span>] = <span class="string">'平均值'</span></span><br><span class="line">sum[<span class="string">'name'</span>] = <span class="string">'总和'</span></span><br><span class="line"><span class="comment"># 将Nan转为空</span></span><br><span class="line">table = table.append([total,sum], ignore_index=<span class="literal">True</span>).fillna(<span class="string">''</span>)</span><br><span class="line">print(table)</span><br><span class="line"></span><br><span class="line">name    age  score student            qq</span><br><span class="line"><span class="number">0</span>    韩信   <span class="number">21.0</span>   <span class="number">80.0</span>      韩信  <span class="number">1.242424e+08</span></span><br><span class="line"><span class="number">1</span>    赵云   <span class="number">22.0</span>   <span class="number">10.0</span>      赵云  <span class="number">1.234236e+07</span></span><br><span class="line"><span class="number">2</span>    李白   <span class="number">22.0</span>   <span class="number">30.0</span>      李白  <span class="number">5.745346e+08</span></span><br><span class="line"><span class="number">3</span>    杜甫   <span class="number">24.0</span>  <span class="number">100.0</span>      杜甫  <span class="number">6.785842e+06</span></span><br><span class="line"><span class="number">4</span>    曹操   <span class="number">18.0</span>   <span class="number">75.0</span>      曹操  <span class="number">3.456334e+07</span></span><br><span class="line"><span class="number">5</span>    姜尚   <span class="number">45.0</span>   <span class="number">75.0</span>      姜尚  <span class="number">5.784526e+07</span></span><br><span class="line"><span class="number">6</span>    阿狗   <span class="number">23.0</span>   <span class="number">11.0</span>      阿狗  <span class="number">4.564583e+07</span></span><br><span class="line"><span class="number">7</span>    筱倩    <span class="number">3.0</span>   <span class="number">99.0</span>      筱倩  <span class="number">5.836474e+07</span></span><br><span class="line"><span class="number">8</span>    夫子  <span class="number">123.0</span>  <span class="number">107.0</span>      夫子  <span class="number">4.824855e+09</span></span><br><span class="line"><span class="number">9</span>    葛聂   <span class="number">33.0</span>   <span class="number">90.0</span>       <span class="number">0</span>  <span class="number">0.000000e+00</span></span><br><span class="line"><span class="number">10</span>  平均值   <span class="number">33.4</span>   <span class="number">67.7</span>          <span class="number">5.739179e+08</span></span><br><span class="line"><span class="number">11</span>   总和  <span class="number">334.0</span>  <span class="number">677.0</span>          <span class="number">5.739179e+09</span></span><br></pre></td></tr></table></figure>



<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p><code>.sort_values(by=[],inplace=True,ascending=[False])</code></p>
<p>默认生成一个新的DataFrame，使用inplace=True在原DataFrame上修改</p>
<p>默认使用升序排列，用ascending=False来降序排列</p>
<ol>
<li>对一列数据进行排序</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">24</span>])</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">100</span>])</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:sr2, <span class="string">'B'</span>:sr3&#125;)</span><br><span class="line">df.set_index(<span class="string">'A'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.sort_values(by=<span class="string">'A'</span>, inplace=<span class="literal">True</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>对多列数据进行排序，而且第一列倒序，第二列升序</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">24</span>])</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">100</span>])</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">'A'</span>:sr2, <span class="string">'B'</span>:sr3&#125;)</span><br><span class="line">df.set_index(<span class="string">'A'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.sort_values(by=[<span class="string">'A'</span>,<span class="string">'B'</span>], inplace=<span class="literal">True</span>, ascending=[<span class="literal">False</span>,<span class="literal">True</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="数据相关性"><a href="#数据相关性" class="headerlink" title="数据相关性"></a>数据相关性</h2><p>之前在一篇文章中看到<code>df.corr()</code>时，没看懂它到底什么意思，有什么作用。今天看了老师讲的视频，才发现这个东西超级无敌厉害。它就是分析一个表中每两列数据之间的相关性的。</p>
<ul>
<li>1.0代表完全相关</li>
<li>比例越大，相关性越大</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">22</span>,<span class="number">24</span>])</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">100</span>])</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">'age'</span>:sr2, <span class="string">'score'</span>:sr3&#125;)</span><br><span class="line">df.corr()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以看出score与age之间的相关性比较小，仅有0.3</span></span><br><span class="line">			age	score</span><br><span class="line">age		<span class="number">1.000000</span>	<span class="number">0.322749</span></span><br><span class="line">score	<span class="number">0.322749</span>	<span class="number">1.000000</span></span><br></pre></td></tr></table></figure>



<h2 id="从不同sheet页读取"><a href="#从不同sheet页读取" class="headerlink" title="从不同sheet页读取"></a>从不同sheet页读取</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">print(df1)</span><br><span class="line">print(df2)</span><br><span class="line"><span class="comment"># table = df1.merge(df2, on='name')</span></span><br><span class="line"><span class="comment"># print(table)</span></span><br><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span></span><br><span class="line"><span class="number">9</span>   葛聂   <span class="number">33</span>     <span class="number">90</span></span><br><span class="line">  name          qq</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">124242423</span></span><br><span class="line"><span class="number">1</span>   赵云    <span class="number">12342356</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">574534563</span></span><br><span class="line"><span class="number">3</span>   杜甫     <span class="number">6785842</span></span><br><span class="line"><span class="number">4</span>   曹操    <span class="number">34563342</span></span><br><span class="line"><span class="number">5</span>   姜尚    <span class="number">57845262</span></span><br><span class="line"><span class="number">6</span>   阿狗    <span class="number">45645834</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">58364743</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">4824854834</span></span><br></pre></td></tr></table></figure>



<h2 id="多表联合查询"><a href="#多表联合查询" class="headerlink" title="多表联合查询"></a>多表联合查询</h2><p>用到了与数据库类似的操作，merge两个DataFrame，默认为inner join,可以设置left/right join</p>
<ul>
<li><code>df.merge()</code>需要指定关联的列，具有内连接，左/右连接</li>
<li><code>df.join()</code>默认使用index作为关联的列，不具有内连接，左/右连接</li>
<li><code>pandas.concat([],axis=num)</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">table = df1.merge(df2, on=<span class="string">'name'</span>)</span><br><span class="line">print(table)</span><br><span class="line"></span><br><span class="line">	name  age  score          qq</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span>   <span class="number">124242423</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span>    <span class="number">12342356</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span>   <span class="number">574534563</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span>     <span class="number">6785842</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span>    <span class="number">34563342</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span>    <span class="number">57845262</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span>    <span class="number">45645834</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span>    <span class="number">58364743</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span>  <span class="number">4824854834</span></span><br></pre></td></tr></table></figure>

<p>可以发现默认是使用的inner join，要df1的数据全部显示出来，使用left join方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table = df1.merge(df2, how=<span class="string">'left'</span>, on=<span class="string">'name'</span>)</span><br></pre></td></tr></table></figure>

<p>如果要关联的两张表的columns名字不同，那么不能使用<code>on</code>，而需要使用<code>left_on=&#39;&#39;,right_on=&#39;&#39;</code>来连接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">	name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span></span><br><span class="line"><span class="number">9</span>   葛聂   <span class="number">33</span>     <span class="number">90</span></span><br><span class="line"></span><br><span class="line">  student          qq</span><br><span class="line"><span class="number">0</span>      韩信   <span class="number">124242423</span></span><br><span class="line"><span class="number">1</span>      赵云    <span class="number">12342356</span></span><br><span class="line"><span class="number">2</span>      李白   <span class="number">574534563</span></span><br><span class="line"><span class="number">3</span>      杜甫     <span class="number">6785842</span></span><br><span class="line"><span class="number">4</span>      曹操    <span class="number">34563342</span></span><br><span class="line"><span class="number">5</span>      姜尚    <span class="number">57845262</span></span><br><span class="line"><span class="number">6</span>      阿狗    <span class="number">45645834</span></span><br><span class="line"><span class="number">7</span>      筱倩    <span class="number">58364743</span></span><br><span class="line"><span class="number">8</span>      夫子  <span class="number">4824854834</span></span><br></pre></td></tr></table></figure>

<p>关联之后数据会出现Nan值，使用<code>fillna()</code>函数来填充null</p>
<p>如果显示的是小数或者科学计数，可以使用<code>astype()</code>设置为数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">table = df1.merge(df2, how=<span class="string">'left'</span>, left_on=<span class="string">'name'</span>, right_on=<span class="string">'student'</span>).fillna(<span class="number">0</span>)</span><br><span class="line">table[<span class="string">'qq'</span>] = table[<span class="string">'qq'</span>].astype(int)</span><br><span class="line">print(table)</span><br><span class="line"></span><br><span class="line">	name  age  score student          qq</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span>      韩信   <span class="number">124242423</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span>      赵云    <span class="number">12342356</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span>      李白   <span class="number">574534563</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span>      杜甫     <span class="number">6785842</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span>      曹操    <span class="number">34563342</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span>      姜尚    <span class="number">57845262</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span>      阿狗    <span class="number">45645834</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span>      筱倩    <span class="number">58364743</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span>      夫子  <span class="number">4824854834</span></span><br><span class="line"><span class="number">9</span>   葛聂   <span class="number">33</span>     <span class="number">90</span>       <span class="number">0</span>           <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>使用<code>join()</code>函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df1 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br><span class="line">df2 = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, sheet_name=<span class="string">'Sheet2'</span>)</span><br><span class="line"></span><br><span class="line">table = df1.join(df2, how=<span class="string">'left'</span>).fillna(<span class="number">0</span>)</span><br><span class="line">table[<span class="string">'qq'</span>] = table[<span class="string">'qq'</span>].astype(int)</span><br><span class="line">print(table)</span><br><span class="line"></span><br><span class="line">	name  age  score student          qq</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span>      韩信   <span class="number">124242423</span></span><br><span class="line"><span class="number">1</span>   赵云   <span class="number">22</span>     <span class="number">10</span>      赵云    <span class="number">12342356</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">30</span>      李白   <span class="number">574534563</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span>      杜甫     <span class="number">6785842</span></span><br><span class="line"><span class="number">4</span>   曹操   <span class="number">18</span>     <span class="number">75</span>      曹操    <span class="number">34563342</span></span><br><span class="line"><span class="number">5</span>   姜尚   <span class="number">45</span>     <span class="number">75</span>      姜尚    <span class="number">57845262</span></span><br><span class="line"><span class="number">6</span>   阿狗   <span class="number">23</span>     <span class="number">11</span>      阿狗    <span class="number">45645834</span></span><br><span class="line"><span class="number">7</span>   筱倩    <span class="number">3</span>     <span class="number">99</span>      筱倩    <span class="number">58364743</span></span><br><span class="line"><span class="number">8</span>   夫子  <span class="number">123</span>    <span class="number">107</span>      夫子  <span class="number">4824854834</span></span><br><span class="line"><span class="number">9</span>   葛聂   <span class="number">33</span>     <span class="number">90</span>       <span class="number">0</span>           <span class="number">0</span></span><br></pre></td></tr></table></figure>



<h2 id="数据列分割"><a href="#数据列分割" class="headerlink" title="数据列分割"></a>数据列分割</h2><p>使用到了<code>Series.str.split()</code>方法，另外<code>Series.str</code>有很多方法可以用，可以对字符串进行各种操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">'A'</span>:[<span class="string">"hello joyce"</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">8</span>)]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="comment"># 不使用expand，那么数据会作为一个list</span></span><br><span class="line">info = df.A.str.split(expand=<span class="literal">True</span>)</span><br><span class="line">df[<span class="string">'first'</span>] = info[<span class="number">0</span>]</span><br><span class="line">df[<span class="string">'last'</span>] = info[<span class="number">1</span>]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="行列转换"><a href="#行列转换" class="headerlink" title="行列转换"></a>行列转换</h2><p><code>df.transpose()</code>即可，为了避免旋转后第一行为index，所以在读取的时候需要指定index</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, index_col=<span class="string">'name'</span>)</span><br><span class="line">df = df.transpose()</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="提取日期"><a href="#提取日期" class="headerlink" title="提取日期"></a>提取日期</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pandas.DatetimeIndex(df[<span class="string">'column_name'</span>]).year</span><br><span class="line">pandas.DatetimeIndex(df[<span class="string">'column_name'</span>]).month</span><br><span class="line">pandas.DatetimeIndex(df[<span class="string">'column_name'</span>]).day</span><br></pre></td></tr></table></figure>



<h2 id="分组，聚合"><a href="#分组，聚合" class="headerlink" title="分组，聚合"></a>分组，聚合</h2><p>模拟透视表功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df.pivot_table(index=<span class="string">'column_name'</span>, columns=<span class="string">'column_name'</span>, value=<span class="string">'column_name'</span>, aggfunc=np.sum)</span><br></pre></td></tr></table></figure>

<p>分组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groups = df.groupby(<span class="string">'column_name'</span>)</span><br></pre></td></tr></table></figure>

<p>聚合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S = groups[<span class="string">'column_name'</span>].sum()</span><br></pre></td></tr></table></figure>



<h2 id="条件颜色"><a href="#条件颜色" class="headerlink" title="条件颜色"></a>条件颜色</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">colorlize</span><span class="params">(x)</span>:</span></span><br><span class="line">    colors = <span class="string">'orange'</span> <span class="keyword">if</span> x &lt; <span class="number">60</span> <span class="keyword">else</span> <span class="string">'lime'</span></span><br><span class="line">    <span class="comment"># 这里返回的格式必须要是这样</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f'color:<span class="subst">&#123;colors&#125;</span>'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">another</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="comment"># 这里需要返回一个list</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'color:red'</span> <span class="keyword">if</span> v &gt; <span class="number">90</span> <span class="keyword">else</span> <span class="string">'background-color:black'</span> <span class="keyword">for</span> v <span class="keyword">in</span> x] </span><br><span class="line">    </span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可直接添加在后面</span></span><br><span class="line"><span class="comment"># df.style.apply(another, subset=['age','score'])</span></span><br><span class="line">df.style.applymap(colorlize, subset=[<span class="string">'age'</span>,<span class="string">'score'</span>]).apply(another, subset=[<span class="string">'age'</span>,<span class="string">'score'</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418202939418.png" alt="image-20200418202939418"></p>
<p>需要注意的：</p>
<ul>
<li><code>df.style.applymap()</code>获取到的是每一个值</li>
<li><code>df.style.apply()</code>获取到的是一个Series，但是需要用for循环读取每一个值，这和之前用的<code>df.apply()</code>自动循环每一个值不同</li>
</ul>
<h2 id="颜色条"><a href="#颜色条" class="headerlink" title="颜色条"></a>颜色条</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line">df.style.bar(color=<span class="string">'pink'</span>, subset=[<span class="string">'age'</span>,<span class="string">'score'</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418204331053.png" alt="image-20200418204331053"></p>
<h2 id="渐变颜色"><a href="#渐变颜色" class="headerlink" title="渐变颜色"></a>渐变颜色</h2><p>需要下载seaborn模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install seaborn</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sn</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>)</span><br><span class="line">color_map = sn.light_palette(<span class="string">'pink'</span>, as_cmap=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">df.style.background_gradient(color_map, subset=[<span class="string">'age'</span>, <span class="string">'score'</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418204439512.png" alt="image-20200418204439512"></p>
<hr>
<h1 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h1><h2 id="Series序列"><a href="#Series序列" class="headerlink" title="Series序列"></a>Series序列</h2><p>用来生成一维数据。类似list数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">"name"</span>:[<span class="string">"韩信"</span>,<span class="string">"貂蝉"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], <span class="string">"age"</span>:[<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">24</span>], <span class="string">"score"</span>:[<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>]&#125;</span><br><span class="line">sr = pd.Series(data)</span><br><span class="line">print(sr)</span><br><span class="line"></span><br><span class="line">name      [韩信, 貂蝉, 李白, 杜甫]</span><br><span class="line">age       [<span class="number">21</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">24</span>]</span><br><span class="line">score    [<span class="number">80</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">100</span>]</span><br></pre></td></tr></table></figure>

<h2 id="Series组装DataFrame"><a href="#Series组装DataFrame" class="headerlink" title="Series组装DataFrame"></a>Series组装DataFrame</h2><ol>
<li>使用<code>dict</code>组装。不指定index时，使用默认的index</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr1 = pd.Series([<span class="string">"韩信"</span>,<span class="string">"貂蝉"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>])</span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">24</span>])</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>])</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">'name'</span>:sr1, <span class="string">'age'</span>:sr2, <span class="string">'score'</span>:sr3&#125;)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age  score</span><br><span class="line"><span class="number">0</span>   韩信   <span class="number">21</span>     <span class="number">80</span></span><br><span class="line"><span class="number">1</span>   貂蝉   <span class="number">18</span>     <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   李白   <span class="number">22</span>     <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   杜甫   <span class="number">24</span>    <span class="number">100</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>还可以手动指定index</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr1 = pd.Series([<span class="string">"韩信"</span>,<span class="string">"貂蝉"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>], index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), name=<span class="string">'name'</span>)</span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">24</span>], index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), name=<span class="string">'age'</span>)</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>], index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">df = pd.DataFrame(&#123;sr1.name:sr1, sr2.name:sr2, sr3.name:sr3&#125;)</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">  name  age  NaN</span><br><span class="line"><span class="number">1</span>   韩信   <span class="number">21</span>   <span class="number">80</span></span><br><span class="line"><span class="number">2</span>   貂蝉   <span class="number">18</span>   <span class="number">80</span></span><br><span class="line"><span class="number">3</span>   李白   <span class="number">22</span>   <span class="number">80</span></span><br><span class="line"><span class="number">4</span>   杜甫   <span class="number">24</span>  <span class="number">100</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>使用<code>list</code>组装。如果不指定index和name，那么会用默认的index来填充columns和index</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">sr1 = pd.Series([<span class="string">"韩信"</span>,<span class="string">"貂蝉"</span>,<span class="string">"李白"</span>,<span class="string">"杜甫"</span>],  index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), name=<span class="string">'name'</span>)</span><br><span class="line">sr2 = pd.Series([<span class="number">21</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">24</span>], index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), name=<span class="string">'age'</span>)</span><br><span class="line">sr3 = pd.Series([<span class="number">80</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">100</span>], index=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>), name=<span class="string">'score'</span>)</span><br><span class="line">df = pd.DataFrame([sr1, sr2, sr3])</span><br><span class="line">print(df)</span><br><span class="line"></span><br><span class="line">        <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>    <span class="number">4</span></span><br><span class="line">name   韩信  貂蝉  李白   杜甫</span><br><span class="line">age    <span class="number">21</span>  <span class="number">18</span>  <span class="number">22</span>   <span class="number">24</span></span><br><span class="line">score  <span class="number">80</span>  <span class="number">80</span>  <span class="number">80</span>  <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p><em>可以发现，使用list来组装DataFrame时，会将Series以行的形式展示。如果用dict来组装，那么会将Series以列的形式组装。</em></p>
<h2 id="DataFrame取出Series"><a href="#DataFrame取出Series" class="headerlink" title="DataFrame取出Series"></a>DataFrame取出Series</h2><p>两种方式：</p>
<ul>
<li>这种就是python自身的语法，DataFrame由字典组成，所以使用<code>df[&#39;column_name&#39;]</code>即可</li>
<li>使用pandas DataFrame数据结构的语法，<code>df.column_name</code>也可以</li>
</ul>
<hr>
<h1 id="制图"><a href="#制图" class="headerlink" title="制图"></a>制图</h1><p>pandas是构建于matplotlib之上，所以需要先下载</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># matplotlib (3.2.1)                 - Python plotting package</span></span><br><span class="line">pip install matplotlib</span><br></pre></td></tr></table></figure>

<p>使用到的数据：</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417203430726.png" alt="1.xlsx"></p>
<h2 id="柱状图"><a href="#柱状图" class="headerlink" title="柱状图"></a>柱状图</h2><p>第一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="comment"># 先排score，再排age，从大到小</span></span><br><span class="line">df.sort_values(by=[<span class="string">'score'</span>,<span class="string">'age'</span>], inplace=<span class="literal">True</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># pandas支持制图</span></span><br><span class="line">df.plot.bar(x=<span class="string">'name'</span>, y=[<span class="string">'score'</span>,<span class="string">'age'</span>], color=[<span class="string">'lightblue'</span>,<span class="string">'orange'</span>])</span><br><span class="line"><span class="comment"># 紧凑显示</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line"><span class="comment"># 使用matplotlib来渲染</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417192602580.png" alt="image-20200417192602580"></p>
<h2 id="中文支持"><a href="#中文支持" class="headerlink" title="中文支持"></a>中文支持</h2><p>默认matplotlib无法显示中文，需要从matplotlib导入font_manager</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager</span><br></pre></td></tr></table></figure>

<p>查看有那些中文字体</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fc-list :lang=zh</span><br><span class="line"></span><br><span class="line">/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei,文泉驛微米黑,文泉驿微米黑:style=Regular</span><br><span class="line">/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc: WenQuanYi Micro Hei Mono,文泉驛等寬微米黑,文泉驿等宽微米黑:style=Regular</span><br></pre></td></tr></table></figure>

<p>设置font变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">font = font_manager.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br></pre></td></tr></table></figure>

<p>在需要显示中文的地方加上fontproperties属性。需要注意只有matplotlib才能加这个属性，所以在需要加这个属性的时候，要用matplotlib来设置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.xticks(rotation=<span class="number">40</span>, fontproperties=font)</span><br></pre></td></tr></table></figure>



<h2 id="使用matplotlib修饰"><a href="#使用matplotlib修饰" class="headerlink" title="使用matplotlib修饰"></a>使用matplotlib修饰</h2><p>matpllotlib比pandas自带的制图功能要多，可定制性更强。导入matplotlib的作用呢就是来补充pandas自身制图功能的一些不足，以及渲染图片。</p>
<p>由于pandas基于matplotlib，所以这两个可完美的搭配使用。在pandas搞不定的地方就用matplotlib来补充</p>
<h2 id="分组柱状图"><a href="#分组柱状图" class="headerlink" title="分组柱状图"></a>分组柱状图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager</span><br><span class="line"></span><br><span class="line">font = font_manager.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取</span></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">df.sort_values(by=[<span class="string">'score'</span>,<span class="string">'age'</span>], inplace=<span class="literal">True</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 用pandas自身绘制分组柱状图</span></span><br><span class="line">df.plot.bar(x=<span class="string">'name'</span>, y=[<span class="string">'score'</span>,<span class="string">'age'</span>], color=[<span class="string">'lightblue'</span>,<span class="string">'orange'</span>])</span><br><span class="line"><span class="comment"># pandas自身绘图的标签不支持中文，那么用matplotlib来让标签显示中文，以及设置一定旋转角度</span></span><br><span class="line"><span class="comment"># plt.xticks(rotation=20, fontproperties=font, fontsize=14)</span></span><br><span class="line"><span class="comment"># 上面这个无法设置旋转中心，所以使用下面的</span></span><br><span class="line"><span class="comment"># gca获取x轴，ha='right'设置右端对齐</span></span><br><span class="line">px = plt.gca()</span><br><span class="line">px.set_xticklabels(df[<span class="string">'name'</span>], rotation=<span class="number">20</span>, ha=<span class="string">'right'</span>, fontproperties=font, fontsize=<span class="number">14</span>)</span><br><span class="line"><span class="comment"># gcf获取图形的布局</span></span><br><span class="line">pf = plt.gcf()</span><br><span class="line">pf.subplots_adjust(left=<span class="number">0.1</span>)</span><br><span class="line"><span class="comment"># 用matplotlib来设置x轴名称</span></span><br><span class="line">plt.xlabel(<span class="string">'name'</span>, fontsize=<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 用matplotlib来设置y轴名称</span></span><br><span class="line">plt.ylabel(<span class="string">'score'</span>, fontsize=<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 用matplotlib来设置title</span></span><br><span class="line">plt.title(<span class="string">'学习情况统计表'</span>, fontproperties=font, fontsize=<span class="number">24</span>, color=<span class="string">'lightpink'</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>



<p><img src="/home/narcissus/Desktop/Figure_1.png" alt=""></p>
<h2 id="叠加柱状图"><a href="#叠加柱状图" class="headerlink" title="叠加柱状图"></a>叠加柱状图</h2><ul>
<li>需要自己新计算一个新的列，这个列的值为需要叠加的数据之和</li>
<li>使用这个新的列作为排序的标准</li>
<li>y轴仍然为之前的列</li>
<li>只不过在df.plot.bar显示的时候加了一个参数<code>stacked=True</code>，声明使用叠加的方式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot  <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager</span><br><span class="line"></span><br><span class="line">font = font_manager.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], skiprows=<span class="number">1</span>)</span><br><span class="line">df[<span class="string">'total'</span>] = df[<span class="string">'age'</span>] + df[<span class="string">'score'</span>]</span><br><span class="line">df.sort_values(by=<span class="string">'total'</span>, inplace=<span class="literal">True</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">df.plot.bar(x=<span class="string">'name'</span>, y=[<span class="string">'score'</span>, <span class="string">'age'</span>], color=[<span class="string">'brown'</span>,<span class="string">'pink'</span>], stacked=<span class="literal">True</span>)</span><br><span class="line">px = plt.gca()</span><br><span class="line">px.set_xticklabels(df[<span class="string">'name'</span>], rotation=<span class="number">10</span>, ha=<span class="string">'right'</span>, fontproperties=font)</span><br><span class="line">plt.xlabel(<span class="string">'name'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'count'</span>)</span><br><span class="line">plt.title(<span class="string">'学习情况统计'</span>, fontproperties=font, fontsize=<span class="number">22</span>, fontweight=<span class="string">'bold'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417202420437.png" alt="image-20200417202420437"></p>
<h2 id="水平叠加柱状图"><a href="#水平叠加柱状图" class="headerlink" title="水平叠加柱状图"></a>水平叠加柱状图</h2><p>其实只需要改一个参数就可以了，将<code>df.plot.bar</code>改为<code>df.plot.barh</code>就代表水平展示了。</p>
<ul>
<li>这个时候的排序可能需要调整一下</li>
<li>如果自定义了x轴，y轴的话，需要交换一下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot  <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager</span><br><span class="line"></span><br><span class="line">font = font_manager.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], skiprows=<span class="number">1</span>)</span><br><span class="line">df[<span class="string">'total'</span>] = df[<span class="string">'age'</span>] + df[<span class="string">'score'</span>]</span><br><span class="line">df.sort_values(by=<span class="string">'total'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">df.plot.barh(x=<span class="string">'name'</span>, y=[<span class="string">'score'</span>, <span class="string">'age'</span>], color=[<span class="string">'brown'</span>,<span class="string">'pink'</span>], stacked=<span class="literal">True</span>)</span><br><span class="line">px = plt.gca()</span><br><span class="line">px.set_yticklabels(df[<span class="string">'name'</span>], rotation=<span class="number">10</span>, ha=<span class="string">'right'</span>, fontproperties=font)</span><br><span class="line">plt.xlabel(<span class="string">'count'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'name'</span>)</span><br><span class="line">plt.title(<span class="string">'学习情况统计'</span>, fontproperties=font, fontsize=<span class="number">22</span>, fontweight=<span class="string">'bold'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417202957849.png" alt="image-20200417202957849"></p>
<h2 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h2><p>绘制饼图的优点是可以清晰的看出各部分所占的比例</p>
<p>与柱状图不同，饼图需要的数据为一个Series，同时在读取数据的时候指定的index会成为饼图显示的信息</p>
<ul>
<li>饼图注意点还挺多的，最为重要的就是使用pandas来绘制，无法显示中文，所以采用了plt来绘制</li>
<li>采用matplotlib时，也无法直接设置字体，需要用循环给具体的对象赋值</li>
<li>对序列排序，并通过绘制时的顺时针来设置旋转方向</li>
<li>通过startangle来设置最大值从12点方向开始</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager <span class="keyword">as</span> fm </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line">font = fm.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="comment"># 为了顺序显示，进行排序。这里没有从大到小排是因为后面绘制的时候可以使用counterclock来设置顺时针排序</span></span><br><span class="line">df.sort_values(by=<span class="string">'score'</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 使用pandas自身的绘图，无法显示中文，所以不采用</span></span><br><span class="line"><span class="comment"># df['score'].plot.pie(labels=df['name'])</span></span><br><span class="line"><span class="comment"># 使用matplotlib来绘制图形，label为标签名</span></span><br><span class="line">paint = plt.pie(df[<span class="string">'score'</span>], labels=df[<span class="string">'name'</span>], counterclock=<span class="literal">True</span>, startangle=<span class="number">-270</span>)</span><br><span class="line"><span class="comment"># 即便是通过matplotlib来绘制，中文也不好显示，只能通过返回值来找到text所在位置，并循环设置中文字体</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> df.index:</span><br><span class="line">    paint[<span class="number">1</span>][i].set_fontproperties(font)</span><br><span class="line">plt.title(<span class="string">'学习情况统计'</span>, fontproperties=font, fontsize=<span class="number">22</span>, fontweight=<span class="string">'bold'</span>)</span><br><span class="line"><span class="comment"># ylabel来设置左边显示文字</span></span><br><span class="line">plt.ylabel(<span class="string">'score'</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>对数据进行排序之后会出现，比例较小的部分字重叠，这也是一个问题。</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417220253777.png" alt="排序"></p>
<p>所以不对其进行排序显示的效果可能会更好。</p>
<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417220601412.png" alt="未排序"></p>
<h2 id="折线图"><a href="#折线图" class="headerlink" title="折线图"></a>折线图</h2><ul>
<li>折线图在绘制的时候，只要直接使用<code>.plot</code>就可以了。需要指定y轴的数据</li>
<li>x轴的数据可以通过指定index来设置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt </span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager <span class="keyword">as</span> fm </span><br><span class="line"></span><br><span class="line">font = fm.FontProperties(fname=<span class="string">'/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc'</span>)</span><br><span class="line">data = &#123;<span class="string">'score'</span>:[<span class="number">45</span>,<span class="number">76</span>,<span class="number">56</span>,<span class="number">100</span>,<span class="number">93</span>], <span class="string">'age'</span>:[<span class="number">16</span>,<span class="number">18</span>,<span class="number">24</span>,<span class="number">29</span>,<span class="number">35</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">df.plot(y=[<span class="string">'score'</span>,<span class="string">'age'</span>])</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">'年龄与分数走势图'</span>,fontproperties=font, fontsize=<span class="number">22</span>)</span><br><span class="line">plt.xlabel(<span class="string">'time'</span>)</span><br><span class="line">plt.xticks(df.index)</span><br><span class="line">plt.ylabel(<span class="string">'count'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417223035065.png" alt="image-20200417223035065"></p>
<h2 id="叠加区域图"><a href="#叠加区域图" class="headerlink" title="叠加区域图"></a>叠加区域图</h2><p>只需要在折线图的基础上将<code>.plot</code>改为<code>.plot.area</code>即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.plot.area(y=[<span class="string">'score'</span>,<span class="string">'age'</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200417223407312.png" alt="image-20200417223407312"></p>
<h2 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h2><p>散点图就可以看出pandas的处理速度完胜excel，同时交换x，y轴数据，pandas可以轻松搞定，而excel在数据量多的时候无法操作。</p>
<ul>
<li>使用到了<code>df.plot.scatter()</code>来画散点图</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager <span class="keyword">as</span> fm </span><br><span class="line"></span><br><span class="line">font = fm.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">df.plot.scatter(x=<span class="string">'score'</span>, y=<span class="string">'age'</span>, color=<span class="string">'brown'</span>)</span><br><span class="line">plt.title(<span class="string">'学习与年龄散点图'</span>, fontproperties=font, fontsize=<span class="number">22</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418095053048.png" alt="image-20200418095053048"></p>
<h2 id="分布图"><a href="#分布图" class="headerlink" title="分布图"></a>分布图</h2><p>可以清晰的看出指定数据的分布情况。分布图只需要Series就可以</p>
<ul>
<li>使用了<code>Series.plot.hist(bins=num)</code></li>
<li>参数bins设置划分区间，越多图越精细</li>
<li><code>plt.xticks()</code>设置x轴的分段，默认Series分段少，使用range()函数，来设置步长</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager <span class="keyword">as</span> fm </span><br><span class="line"></span><br><span class="line">font = fm.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">df[<span class="string">'score'</span>].plot.hist(bins=<span class="number">10</span>)</span><br><span class="line">plt.xticks(range(<span class="number">0</span>,max(df[<span class="string">'score'</span>]),<span class="number">4</span>), rotation=<span class="number">90</span>)</span><br><span class="line">plt.xlabel(<span class="string">'score'</span>)</span><br><span class="line">plt.title(<span class="string">'分数分布图'</span>, fontproperties=font, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418103216628.png" alt="image-20200418103216628"></p>
<h2 id="密度图"><a href="#密度图" class="headerlink" title="密度图"></a>密度图</h2><p>直接使用会报错，提示缺少一个scipy的科学库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># scipy (1.4.1)                   - SciPy: Scientific Library for Python</span></span><br><span class="line">pip install scipy</span><br></pre></td></tr></table></figure>



<p>密度图同样使用Series</p>
<ul>
<li>使用<code>Series.plot.kde()</code>,其它与分布图类似</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> font_manager <span class="keyword">as</span> fm </span><br><span class="line"></span><br><span class="line">font = fm.FontProperties(fname=<span class="string">"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc"</span>)</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">'~/Desktop/1.xlsx'</span>, skiprows=<span class="number">1</span>, usecols=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">df[<span class="string">'score'</span>].plot.kde()</span><br><span class="line">plt.xlabel(<span class="string">'score'</span>)</span><br><span class="line">plt.title(<span class="string">'密度分布图'</span>, fontproperties=font, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="/home/narcissus/.config/Typora/typora-user-images/image-20200418104716779.png" alt="image-20200418104716779"></p>
<hr>
<p>终于一口气学完了这个模块，感觉功能确实很多，而且没学到的功能还有很多。但是就目前掌握的这些来说，写个自动化办公的脚本来说已经够了。数据的读取，增删查改，制图等等功能都很好用。虽然是一边看视频，一边敲代码，但是熟悉程度还不够，还的在日常的生活中多用才会熟练。学完一个东西觉得很开心，但是又觉得有点失落，因为我接下来要学什么呢？是个很大的问题。要不学学powershell吧！</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#安装"><span class="toc-number">1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三种数据结构"><span class="toc-number">2.</span> <span class="toc-text">三种数据结构</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简单读取写入"><span class="toc-number">3.</span> <span class="toc-text">简单读取写入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#excel"><span class="toc-number">3.1.</span> <span class="toc-text">excel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql"><span class="toc-number">3.2.</span> <span class="toc-text">mysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlite"><span class="toc-number">3.3.</span> <span class="toc-text">sqlite</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json"><span class="toc-number">3.4.</span> <span class="toc-text">json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#csv-tsv-txt"><span class="toc-number">3.5.</span> <span class="toc-text">csv&#x2F;tsv&#x2F;txt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#写入"><span class="toc-number">3.6.</span> <span class="toc-text">写入</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DataFrame"><span class="toc-number">4.</span> <span class="toc-text">DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建"><span class="toc-number">4.1.</span> <span class="toc-text">创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自己指定index"><span class="toc-number">4.2.</span> <span class="toc-text">自己指定index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#通过index找出对应数据"><span class="toc-number">4.3.</span> <span class="toc-text">通过index找出对应数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#指定header"><span class="toc-number">4.4.</span> <span class="toc-text">指定header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看开头和结尾"><span class="toc-number">4.5.</span> <span class="toc-text">查看开头和结尾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看数据信息"><span class="toc-number">4.6.</span> <span class="toc-text">查看数据信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看行列数"><span class="toc-number">4.7.</span> <span class="toc-text">查看行列数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加与去重"><span class="toc-number">4.8.</span> <span class="toc-text">添加与去重</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加DataFrame"><span class="toc-number">4.8.1.</span> <span class="toc-text">添加DataFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加Series"><span class="toc-number">4.8.2.</span> <span class="toc-text">添加Series</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加列"><span class="toc-number">4.8.3.</span> <span class="toc-text">添加列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到重复数据"><span class="toc-number">4.8.4.</span> <span class="toc-text">找到重复数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#去重"><span class="toc-number">4.8.5.</span> <span class="toc-text">去重</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改"><span class="toc-number">4.9.</span> <span class="toc-text">修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#替换"><span class="toc-number">4.10.</span> <span class="toc-text">替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插入"><span class="toc-number">4.11.</span> <span class="toc-text">插入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#行"><span class="toc-number">4.11.1.</span> <span class="toc-text">行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列"><span class="toc-number">4.11.2.</span> <span class="toc-text">列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除"><span class="toc-number">4.12.</span> <span class="toc-text">删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#行-1"><span class="toc-number">4.12.1.</span> <span class="toc-text">行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列-1"><span class="toc-number">4.12.2.</span> <span class="toc-text">列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#columns"><span class="toc-number">4.13.</span> <span class="toc-text">columns</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Null数据行清除"><span class="toc-number">4.14.</span> <span class="toc-text">Null数据行清除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Null数据列的清除"><span class="toc-number">4.15.</span> <span class="toc-text">Null数据列的清除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用mean来填充null数据列"><span class="toc-number">4.16.</span> <span class="toc-text">使用mean来填充null数据列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取数据描述"><span class="toc-number">4.17.</span> <span class="toc-text">获取数据描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看某列数据相同数据的个数"><span class="toc-number">4.18.</span> <span class="toc-text">查看某列数据相同数据的个数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#重组DataFrame"><span class="toc-number">4.19.</span> <span class="toc-text">重组DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据的过滤"><span class="toc-number">4.20.</span> <span class="toc-text">数据的过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#在Series的基础上过滤"><span class="toc-number">4.20.1.</span> <span class="toc-text">在Series的基础上过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在DataFrame基础上过滤"><span class="toc-number">4.20.2.</span> <span class="toc-text">在DataFrame基础上过滤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从指定行或列开始读取"><span class="toc-number">4.21.</span> <span class="toc-text">从指定行或列开始读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自动填充功能"><span class="toc-number">4.22.</span> <span class="toc-text">自动填充功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算功能"><span class="toc-number">4.23.</span> <span class="toc-text">计算功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x轴向乘法"><span class="toc-number">4.23.1.</span> <span class="toc-text">x轴向乘法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x轴向求和-平均"><span class="toc-number">4.23.2.</span> <span class="toc-text">x轴向求和&#x2F;平均</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#y轴向求和-平均并添加到DataFrame"><span class="toc-number">4.23.3.</span> <span class="toc-text">y轴向求和&#x2F;平均并添加到DataFrame</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#排序"><span class="toc-number">4.24.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据相关性"><span class="toc-number">4.25.</span> <span class="toc-text">数据相关性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从不同sheet页读取"><span class="toc-number">4.26.</span> <span class="toc-text">从不同sheet页读取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多表联合查询"><span class="toc-number">4.27.</span> <span class="toc-text">多表联合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据列分割"><span class="toc-number">4.28.</span> <span class="toc-text">数据列分割</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#行列转换"><span class="toc-number">4.29.</span> <span class="toc-text">行列转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提取日期"><span class="toc-number">4.30.</span> <span class="toc-text">提取日期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组，聚合"><span class="toc-number">4.31.</span> <span class="toc-text">分组，聚合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#条件颜色"><span class="toc-number">4.32.</span> <span class="toc-text">条件颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#颜色条"><span class="toc-number">4.33.</span> <span class="toc-text">颜色条</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#渐变颜色"><span class="toc-number">4.34.</span> <span class="toc-text">渐变颜色</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Series"><span class="toc-number">5.</span> <span class="toc-text">Series</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Series序列"><span class="toc-number">5.1.</span> <span class="toc-text">Series序列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Series组装DataFrame"><span class="toc-number">5.2.</span> <span class="toc-text">Series组装DataFrame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DataFrame取出Series"><span class="toc-number">5.3.</span> <span class="toc-text">DataFrame取出Series</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#制图"><span class="toc-number">6.</span> <span class="toc-text">制图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#柱状图"><span class="toc-number">6.1.</span> <span class="toc-text">柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#中文支持"><span class="toc-number">6.2.</span> <span class="toc-text">中文支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用matplotlib修饰"><span class="toc-number">6.3.</span> <span class="toc-text">使用matplotlib修饰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组柱状图"><span class="toc-number">6.4.</span> <span class="toc-text">分组柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#叠加柱状图"><span class="toc-number">6.5.</span> <span class="toc-text">叠加柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#水平叠加柱状图"><span class="toc-number">6.6.</span> <span class="toc-text">水平叠加柱状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#饼图"><span class="toc-number">6.7.</span> <span class="toc-text">饼图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#折线图"><span class="toc-number">6.8.</span> <span class="toc-text">折线图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#叠加区域图"><span class="toc-number">6.9.</span> <span class="toc-text">叠加区域图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#散点图"><span class="toc-number">6.10.</span> <span class="toc-text">散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分布图"><span class="toc-number">6.11.</span> <span class="toc-text">分布图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#密度图"><span class="toc-number">6.12.</span> <span class="toc-text">密度图</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://ulomo.github.io/2020/04/18/pandas/" target="_blank" rel="noopener"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://ulomo.github.io/2020/04/18/pandas/&text=pandas" target="_blank" rel="noopener"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://ulomo.github.io/2020/04/18/pandas/&is_video=false&description=pandas" target="_blank" rel="noopener"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pandas&body=Check out this article: https://ulomo.github.io/2020/04/18/pandas/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://ulomo.github.io/2020/04/18/pandas/&title=pandas" target="_blank" rel="noopener"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://ulomo.github.io/2020/04/18/pandas/&name=pandas&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 fsl
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<link rel="stylesheet" href="/lib/meslo-LG/styles.css">


<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">



<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


